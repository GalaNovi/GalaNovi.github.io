!function(f){function n(t){this.config=f.extend(!0,{containerClass:"custom-select",width:0,maxItems:0,customScroll:1,speedAnimation:200,smartPosition:!0,minScrollHeight:10},t||{})}var s=!1,h=!1,u=!1,t=/android|iphone|ipad|ipod|android/i.test(navigator.userAgent.toLowerCase()),l=/opera/i.test(navigator.userAgent.toLowerCase()),e=/msie/i.test(navigator.userAgent.toLowerCase()),o="[object OperaMini]"===Object.prototype.toString.call(window.operamini);n.prototype={_init:function(t){this.$cselect=f(t),this.cselect=t,this.scrollL=!1,this.change=!1,this.fixScroll=!1,this.mouseDown=!1,0==this.config.width&&(this.$cselect.wrap("<span/>"),this.config.width=this.$cselect.parent().width(),this.$cselect.parent().replaceWith(this.$cselect)),this._generateContainer(),this._handlers()},_generateContainer:function(){this.$cselect.wrap('<div class="'+this.config.containerClass+("disabled"===this.$cselect.attr("disabled")?" disabled":"")+'"></div>'),this.$container=this.$cselect.parent(),this._getList({refreshHtml:!1})},_getList:function(t){this.count=this.cselect.length,t.refreshSelect&&f(".select-list",this.$container).remove();var e=this._generateHtml(),i=0<this.config.maxItems&&1==this.config.customScroll?'<div class="select-scroll"><span class="scroll-drag">\x3c!-- --\x3e</span></div>':"",s=1==this.config.customScroll?"custom-scroll":"default-scroll";this.$selected=f("option:selected",this.$cselect),t.refreshSelect?f(e='<div class="select-list '+s+'">'+i+"<ul>"+e+"</ul></div>").prependTo(this.$container):(e='<span class="custom-text">'+this.$selected[0].text+'</span><div class="select-list '+s+'">'+i+"<ul>"+e+"</ul></div>",f(e).prependTo(this.$container)),this.$list=f("ul",this.$container),this.$text=f(".custom-text",this.$container),this.$listContainer=f(".select-list",this.$container),this._clickHandler(),f("li:eq("+this.$selected.index()+")",this.$list).addClass("selected"),this.$container.removeClass("done"),this.setWidthCS(this.config.width),this.standardTop=parseInt(this.$listContainer.css("top")),this._getLength({refreshSelect:t.refreshSelect})},_generateHtml:function(){this.$collection=this.$cselect.children();for(var t="",e=0;e<this.$collection.length;e++){var i=f(this.$collection[e]);t+='<li class="'+("disabled"===i.attr("disabled")?"disabled":"")+'" data-value="'+i[0].value+'">'+(i.data("selectik")?i.data("selectik"):i[0].text)+"</li>"}return t},_getLength:function(t){if(t.refreshSelect||(this.heightItem=f("li:nth-child(1)",this.$list).outerHeight()),this.count<=this.config.maxItems||0==this.config.maxItems)return this.$listContainer.hide(),this.$container.addClass("done"),void(this.scrollL=!1);this.scrollL=!0,this.heightList=this.heightItem*this.count,this.heightContainer=this.heightItem*this.config.maxItems,this.$list.css("height",this.heightContainer),this.$listContainer.hide(),this.$container.addClass("done"),1==this.config.customScroll&&this._getScroll()},_getScroll:function(){var t=this.heightItem*this.count;this.heightShift=-t+this.heightContainer,this.$bgScroll=f(".select-scroll",this.$listContainer),this.$bgScroll.css("height",this.heightContainer),this.$scroll=f(".scroll-drag",this.$listContainer),this.$listContainer.addClass("maxlength"),this.relating=t/this.heightContainer,this.heightScroll=this.heightContainer*(this.heightContainer/t),this.heightScroll<this.config.minScrollHeight&&(this.heightScroll=this.config.minScrollHeight,this.fixScroll=!0),this.$scroll.css("height",this.heightScroll),0<f(".selected",this.$list).length&&this._shift(f(".selected",this.$list).index()),this.config.customScroll&&this._scrollHandlers()},_scrollHandlers:function(){var i,s=this;this.$list.bind("mousewheel",function(t,e){return i=parseInt(s.$list.css("top"))+e*s.heightItem,s._shiftHelper(i),!1}),this.$bgScroll.click(function(t){var e=.5<(t.pageY-f(this).offset().top)/s.heightContainer?-1:1;return i=parseInt(s.$list.css("top"))+s.heightItem*e,s._shiftHelper(i),!1}),this.$text.on("mousedown",function(t){s._draggable(t,!0)}),this.$scroll.on("mousedown",function(t){u=!1,s._draggable(t,!0)}),f(document).on("mouseup",function(t){s._draggable(t,!1)})},_draggable:function(t,e){var c=this;if(e){s=!1,t.preventDefault()&&t.preventDefault();var a=parseInt(c.$scroll.css("top")),r=t.clientY,d=c.$text.outerHeight();f(document).bind("mousemove",function(t){if(u){var e=c.$list.parent().offset().top,i=c.$list.outerHeight(),s=(c.topPosition,0<c.topPosition?d:0),n=t.clientY-(e-s-f(window).scrollTop());if(n<0||i+d<n){var h=n<0?1:-1,l=parseInt(c.$list.css("top"))+h*c.heightItem;c._shiftHelper(l)}}else{var o=r-t.clientY-a;c._shiftHelper(o*c.relating)}})}else f(document).unbind("mousemove"),s=!0},_shiftHelper:function(t){t=(t=0<t?0:t)<this.heightShift?this.heightShift:t,this.$list.css("top",t);var e=this.fixScroll?-(t/this.relating+t/this.heightShift*this.config.minScrollHeight):-t/this.relating;this.$scroll.css("top",e)},_shift:function(t){if(!(t<0||t==this.count)){this.topShift=t>this.count-this.config.maxItems?this.heightList-this.heightContainer:this.heightItem*t,f(".selected",this.$list).removeClass("selected");var e=f("li:nth-child("+(t+1)+")",this.$list);e.addClass("selected"),this.scrollL&&this._shiftHelper(-this.topShift)}},_clickHandler:function(){var e=this;this.$listContainer.off("mousedown","li").on("mousedown","li",function(t){if(e.change)return!(e.change=!1);e._checkDisabled(f(this),t)&&(e.change=!0,e._changeSelected(f(this)))})},_handlers:function(){var e=this,t=f('input[type="reset"]',this.$cselect.parents("form"));0<t.length&&t.bind("click",function(){var t=0<e.$selected.length?e.$selected.index():0;e._changeSelected(f("option:eq("+t+")",e.$cselect))}),this.$cselect.bind("change",function(){if(e.change)return!(e.change=!1);e._changeSelected(f("option:selected",f(this)))}),this.$text.bind("click",function(t){if(e.$container.hasClass("disabled")||u)return!1;e.$cselect.focus(),e._fadeList(!1,!0)}),this.$text.bind("mousedown",function(t){e._checkDisabled(e.$container,t)&&(t.preventDefault(),e.mouseDown=!0,setTimeout(function(){e.mouseDown&&(u=!0,e._fadeList(!1,!0))},300))}),this.$text.bind("mouseup",function(){e.mouseDown=!1}),this.$listContainer.on("mouseup","li",function(t){if(!u)return!0;f(this).hasClass("disabled")||(e.change=!0,e._changeSelected(f("option:eq("+f(t.currentTarget).index()+")",e.$cselect)),e.hideCS(!0),u=!1,e.$cselect.focus())}),this.$cselect.bind("focus",function(){e.$container.addClass("active")}),this.$cselect.bind("blur",function(){u||(e.hideCS(!0),e.$container.removeClass("active"))}),this.$cselect.bind("keyup",function(t){e._keysHandlers(t)}),l&&e.$cselect.bind("keydown",function(){h=!0})},_checkDisabled:function(t,e){return!t.hasClass("disabled")||(e.preventDefault(),!1)},_keysHandlers:function(t){13==t.keyCode&&this.$listContainer.is(":visible")&&this._fadeList(!0,!1),e||27==t.keyCode&&this.$listContainer.is(":visible")&&this._fadeList(!0,!0),this.$cselect.change(),this.scrollL&&this._shift(f("option:selected",this.$cselect).index())},_changeSelected:function(t){var e=0<t.parents("select").length?t.attr("value"):t.data("value"),i=t.text();this._changeSelectedHtml(e,i,t.index()+1)},_changeSelectedHtml:function(t,e,i){if(i>this.count||0==i)return!1;this.change=!0;var s=f(".selected",this.$list);f("option:eq("+s.index()+")",this.$cselect).prop("selected",!1),f("option:eq("+(i-1)+")",this.$cselect).prop("selected",!0),this.$cselect.prop("value",t).change(),s.removeClass("selected"),f("li:nth-child("+i+")",this.$list).addClass("selected"),this.$text.text(e)},_fadeList:function(t,e){var i=f("."+this.config.containerClass+".open_list");if(1!=i.length){if(e||(i.children(".select-list").stop(!0,!0).fadeOut(this.config.speedAnimation).parent().toggleClass("open_list"),!t)){s=!1,this.positionCS(),this.$listContainer.stop(!0,!0).fadeToggle(this.config.speedAnimation),this.$listContainer.parent().toggleClass("open_list");setTimeout(function(){s=!0},this.config.speedAnimation)}}else i.children("select").data("selectik").hideCS()},hideCS:function(t){this.$listContainer.fadeOut(this.config.speedAnimation),this.$container.removeClass("open_list"),t||this.$cselect.focus(),s=!0},showCS:function(){s=!1,this.$listContainer.fadeIn(this.config.speedAnimation),this.$container.addClass("open_list")},positionCS:function(){if(this.config.smartPosition){var t=this.$listContainer.parent(),e=this.scrollL?this.config.maxItems*this.heightItem:this.count*this.heightItem,i=this.scrollL?this.config.maxItems:this.count,s=f(window),n=s.scrollTop(),h=s.height()-(t.offset().top-n)-t.outerHeight()<e?-i*this.heightItem-t.outerHeight()/4:this.standardTop;this.topPosition=t.offset().top-n<e&&f("html").height()-t.offset().top>e?this.standardTop:h,this.$listContainer.css("top",this.topPosition)}},refreshCS:function(){this._getList({refreshSelect:!0})},changeCS:function(t){var e=0<t.index?t.index:f('option[value="'+t.value+'"]',this.$cselect).index()+1,i=f("option:nth-child("+e+")",this.$cselect),s=i.attr("value"),n=i.text();this._changeSelectedHtml(s,n,e)},disableCS:function(){this.$cselect.attr("disabled",!0),this.$container.addClass("disabled")},enableCS:function(){this.$cselect.attr("disabled",!1),this.$container.removeClass("disabled")},requiredCS:function(){this.$text.toggleClass("required")},setWidthCS:function(i){f.each([this.$list,this.$text],function(){var t=f(this).parent(),e=t.outerWidth()-t.width()+(f(this).outerWidth()-f(this).width());f(this).css("width",i-e)})}},f.fn.selectik=function(e,s){if(!t&&!o)return this.each(function(){if(!(0<f("optgroup",this).length||"multiple"==f(this).attr("multiple"))&&null==f(this).data("selectik")){var t=new n(e);for(i in s)t[i]=s[i];t._init(this),f(this).data("selectik",t)}})},f(window).resize(function(){if(s){var t=f(".open_list");if(0<!t.length)return;t.children("select").data("selectik").positionCS(f(".select-list:visible"))}}),f(document).bind("click",function(t){if(!f(t.target).hasClass("disabled"))if(h)h=!1;else if(s){s=!1;var e=f(".open_list");if(0<e.length)e.children("select").data("selectik").hideCS(),u=!1}})}(jQuery);